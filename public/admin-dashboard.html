<!DOCTYPE html>
<html lang="ar">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>لوحة تحكم الادمن</title>
  <style>
    /* متغيرات الألوان للدارك مود */
    :root {
      --primary: #0d6efd;
      --primary-dark: #0b5ed7;
      --secondary: #6c757d;
      --success: #198754;
      --danger: #dc3545;
      --warning: #ffc107;
      --info: #0dcaf0;
      --dark-bg: #121212;
      --dark-card: #1e1e1e;
      --dark-border: #2d2d2d;
      --dark-text: #f8f9fa;
      --dark-text-secondary: #adb5bd;
      --medical-blue: #1a73e8;
      --medical-green: #2e7d32;
      --medical-red: #c62828;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Cairo", "Segoe UI", "Noto Sans Arabic", sans-serif;
      direction: rtl;
      background-color: var(--dark-bg);
      color: var(--dark-text);
      min-height: 100vh;
      padding: 20px;
      line-height: 1.6;
    }

    /* ترويسة الصفحة */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding: 25px;
      background: linear-gradient(135deg, var(--medical-blue) 0%, #0d47a1 100%);
      border-radius: 12px;
      color: white;
      box-shadow: 0 4px 20px rgba(13, 110, 253, 0.2);
    }

    .header-content {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo {
      width: 50px;
      height: 50px;
      background: white;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: var(--medical-blue);
      font-weight: bold;
    }

    h1 {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 0;
    }

    .subtitle {
      color: rgba(255, 255, 255, 0.9);
      font-size: 0.9rem;
      margin-top: 5px;
    }

    h2 {
      margin-bottom: 20px;
      color: var(--dark-text);
      padding-bottom: 12px;
      border-bottom: 3px solid var(--medical-blue);
      font-size: 1.4rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    h2 i {
      color: var(--medical-blue);
    }

    /* الأزرار */
    button {
      background: linear-gradient(135deg, var(--medical-blue) 0%, var(--primary-dark) 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    button:hover {
      background: linear-gradient(135deg, var(--primary-dark) 0%, #0a58ca 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(13, 110, 253, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    #logoutBtn {
      background: linear-gradient(135deg, var(--medical-red) 0%, #b71c1c 100%);
    }

    #logoutBtn:hover {
      background: linear-gradient(135deg, #c62828 0%, #a01212 100%);
      box-shadow: 0 4px 12px rgba(198, 40, 40, 0.3);
    }

    /* الجداول */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: var(--dark-card);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    th,
    td {
      border-bottom: 1px solid var(--dark-border);
      padding: 16px 12px;
      text-align: center;
      vertical-align: middle;
    }

    th {
      background: linear-gradient(135deg, var(--medical-blue) 0%, #1a56db 100%);
      color: white;
      font-weight: 600;
      font-size: 0.95rem;
    }

    tbody tr {
      transition: background-color 0.2s;
    }

    tbody tr:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }

    tbody tr:nth-child(even) {
      background-color: rgba(255, 255, 255, 0.02);
    }

    /* حاويات المحتوى */
    .content-section {
      background: var(--dark-card);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      border: 1px solid var(--dark-border);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    /* قسم إرسال الرسائل */
    #messages {
      margin-top: 30px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: var(--dark-text);
      font-weight: 500;
      font-size: 0.95rem;
    }

    textarea,
    input[type="email"],
    input[type="text"],
    select {
      width: 100%;
      padding: 14px;
      background: rgba(255, 255, 255, 0.07);
      border: 1px solid var(--dark-border);
      border-radius: 8px;
      color: var(--dark-text);
      font-size: 1em;
      font-family: inherit;
      transition: border-color 0.2s;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
      line-height: 1.5;
    }

    textarea:focus,
    input:focus,
    select:focus {
      outline: none;
      border-color: var(--medical-blue);
      background: rgba(255, 255, 255, 0.1);
    }

    textarea::placeholder,
    input::placeholder {
      color: var(--dark-text-secondary);
    }

    /* الاستجابات */
    .response {
      margin-top: 15px;
      padding: 14px;
      border-radius: 8px;
      text-align: center;
      font-weight: 500;
      display: none;
    }

    .response.show {
      display: block;
    }

    .success {
      background: rgba(25, 135, 84, 0.15);
      color: var(--success);
      border-right: 4px solid var(--success);
    }

    .error {
      background: rgba(220, 53, 69, 0.15);
      color: var(--danger);
      border-right: 4px solid var(--danger);
    }

    .info {
      background: rgba(13, 202, 240, 0.15);
      color: var(--info);
      border-right: 4px solid var(--info);
    }

    /* أزرار الحذف في الجداول */
    .delete-btn {
      padding: 8px 16px;
      background: linear-gradient(135deg, var(--danger) 0%, #a71d2a 100%);
      font-size: 0.9rem;
      border-radius: 6px;
    }

    .delete-btn:hover {
      background: linear-gradient(135deg, #bb2d3b 0%, #8c1a24 100%);
    }

    /* حالة التحاليل */
    .status {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      display: inline-block;
    }

    .status.pending {
      background: rgba(255, 193, 7, 0.2);
      color: var(--warning);
    }

    .status.completed {
      background: rgba(25, 135, 84, 0.2);
      color: var(--success);
    }

    .status.cancelled {
      background: rgba(220, 53, 69, 0.2);
      color: var(--danger);
    }

    /* إحصائيات */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: var(--dark-card);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      border: 1px solid var(--dark-border);
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }

    .stat-card .number {
      font-size: 2.2rem;
      font-weight: 700;
      color: var(--medical-blue);
      margin-bottom: 5px;
    }

    .stat-card .label {
      color: var(--dark-text-secondary);
      font-size: 0.9rem;
    }

    /* تذييل الصفحة */
    .footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      color: var(--dark-text-secondary);
      font-size: 0.9rem;
      border-top: 1px solid var(--dark-border);
    }

    /* التصميم المتجاوب */
    @media (max-width: 992px) {
      .header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }
      
      .stats-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px) {
      body {
        padding: 15px;
      }

      .header {
        padding: 20px;
      }

      h1 {
        font-size: 1.5rem;
      }

      h2 {
        font-size: 1.2rem;
      }

      table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }

      th, td {
        padding: 12px 8px;
        font-size: 0.9rem;
      }

      .content-section {
        padding: 20px;
      }

      button {
        padding: 10px 20px;
        font-size: 0.9rem;
      }

      .stats-container {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      .header {
        padding: 15px;
      }

      h1 {
        font-size: 1.3rem;
      }

      h2 {
        font-size: 1.1rem;
      }

      th, td {
        padding: 10px 6px;
        font-size: 0.85rem;
      }

      .content-section {
        padding: 15px;
      }
    }

    /* أيقونات */
    .icon {
      font-size: 1.2em;
      vertical-align: middle;
    }
  </style>
  <!-- خط Cairo للعربية -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- أيقونات -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
  <!-- ترويسة الصفحة -->
  <div class="header">
    <div class="header-content">
      <div class="logo">م</div>
      <div>
        <h1>لوحة تحكم الإدمن - مختبر التحاليل الطبية</h1>
        <div class="subtitle">إدارة طلبات التحاليل والمرضى والنتائج</div>
      </div>
    </div>
    <button id="logoutBtn">
      <i class="fas fa-sign-out-alt"></i>
      تسجيل خروج
    </button>
  </div>

  <!-- إحصائيات -->
  <div class="stats-container">
    <div class="stat-card">
      <div class="number" id="totalPatients">0</div>
      <div class="label">إجمالي المرضى</div>
    </div>
    <div class="stat-card">
      <div class="number" id="pendingTests">0</div>
      <div class="label">تحاليل قيد الانتظار</div>
    </div>
    <div class="stat-card">
      <div class="number" id="completedTests">0</div>
      <div class="label">تحاليل مكتملة</div>
    </div>
    <div class="stat-card">
      <div class="number" id="todayAppointments">0</div>
      <div class="label">مواعيد اليوم</div>
    </div>
  </div>

  <!-- قسم بيانات المرضى -->
  <div class="content-section">
    <h2><i class="fas fa-users"></i> بيانات المرضى والتحاليل</h2>
    <table id="patientsTable">
      <thead>
        <tr>
          <th>رقم الملف</th>
          <th>اسم المريض</th>
          <th>العمر</th>
          <th>نوع التحليل</th>
          <th>تاريخ الطلب</th>
          <th>الحالة</th>
          <th>الإجراءات</th>
        </tr>
      </thead>
      <tbody id="patientsTableBody">
        <!-- البيانات سيتم تحميلها بواسطة الجافاسكريبت -->
      </tbody>
    </table>
  </div>

  <!-- قسم إرسال النتائج -->
  <div class="content-section" id="messages">
    <h2><i class="fas fa-envelope"></i> إرسال نتائج التحاليل</h2>
    
    <div class="form-group">
      <label for="patientSelect">اختر المريض:</label>
      <select id="patientSelect" required>
        <option value="">اختر المريض...</option>
        <!-- الخيارات سيتم تحميلها بواسطة الجافاسكريبت -->
      </select>
    </div>

    <div class="form-group">
      <label for="testType">نوع التحليل:</label>
      <select id="testType" required>
        <option value="">اختر نوع التحليل...</option>
        <option value="cbc">تحليل صورة دم كاملة (CBC)</option>
        <option value="lipid">تحليل دهون الدم (Lipid Profile)</option>
        <option value="liver">وظائف الكبد (Liver Function)</option>
        <option value="kidney">وظائف الكلى (Kidney Function)</option>
        <option value="sugar">سكر الدم (Blood Sugar)</option>
        <option value="thyroid">هرمونات الغدة الدرقية (Thyroid)</option>
        <option value="vitamins">تحليل الفيتامينات</option>
        <option value="urine">تحليل البول</option>
        <option value="other">تحاليل أخرى</option>
      </select>
    </div>

    <div class="form-group">
      <label for="resultInput">نتيجة التحليل:</label>
      <textarea id="resultInput" placeholder="أدخل نتيجة التحليل بالتفصيل..." required></textarea>
    </div>

    <div class="form-group">
      <label for="notesInput">ملاحظات إضافية:</label>
      <textarea id="notesInput" placeholder="أي ملاحظات إضافية للمريض..."></textarea>
    </div>

    <button id="sendResultBtn">
      <i class="fas fa-paper-plane"></i>
      إرسال النتيجة
    </button>

    <div id="sendResponse" class="response"></div>
  </div>

  <!-- قسم النتائج المرسلة -->
  <div class="content-section" id="sentResults">
    <h2><i class="fas fa-file-medical"></i> النتائج المرسلة</h2>
    <table id="sentResultsTable">
      <thead>
        <tr>
          <th>اسم المريض</th>
          <th>نوع التحليل</th>
          <th>النتيجة</th>
          <th>تاريخ الإرسال</th>
          <th>الإجراءات</th>
        </tr>
      </thead>
      <tbody id="sentResultsTableBody">
        <!-- البيانات سيتم تحميلها بواسطة الجافاسكريبت -->
      </tbody>
    </table>
  </div>

  <!-- تذييل الصفحة -->
  <div class="footer">
    <p>© 2024 مختبر التحاليل الطبية المتقدم. جميع الحقوق محفوظة.</p>
    <p>لوحة تحكم الإدمن - الإصدار 2.0</p>
  </div>

  <script>
    // عناصر DOM
    const patientsTableBody = document.getElementById('patientsTableBody');
    const sentResultsTableBody = document.getElementById('sentResultsTableBody');
    const logoutBtn = document.getElementById('logoutBtn');
    const sendResultBtn = document.getElementById('sendResultBtn');
    const patientSelect = document.getElementById('patientSelect');
    const testType = document.getElementById('testType');
    const resultInput = document.getElementById('resultInput');
    const notesInput = document.getElementById('notesInput');
    const sendResponse = document.getElementById('sendResponse');
    
    // عناصر الإحصائيات
    const totalPatientsEl = document.getElementById('totalPatients');
    const pendingTestsEl = document.getElementById('pendingTests');
    const completedTestsEl = document.getElementById('completedTests');
    const todayAppointmentsEl = document.getElementById('todayAppointments');

    // بيانات تجريبية للمرضى (ستأتي من قاعدة البيانات في التطبيق الحقيقي)
    const patients = [
      { id: 1001, name: "أحمد محمد محمود", age: 35, testType: "تحليل صورة دم كاملة", requestDate: "2024-01-15", status: "completed", phone: "0123456789", email: "ahmed@example.com" },
      { id: 1002, name: "سارة علي حسن", age: 28, testType: "تحليل دهون الدم", requestDate: "2024-01-16", status: "pending", phone: "0111222333", email: "sara@example.com" },
      { id: 1003, name: "محمد خالد عبدالله", age: 42, testType: "وظائف الكبد", requestDate: "2024-01-14", status: "completed", phone: "0105555666", email: "mohamed@example.com" },
      { id: 1004, name: "فاطمة عمر إبراهيم", age: 31, testType: "سكر الدم", requestDate: "2024-01-17", status: "pending", phone: "0107777888", email: "fatima@example.com" },
      { id: 1005, name: "يوسف سمير رجب", age: 50, testType: "هرمونات الغدة الدرقية", requestDate: "2024-01-13", status: "completed", phone: "0129999000", email: "youssef@example.com" },
      { id: 1006, name: "نورا هاني سليمان", age: 26, testType: "تحليل الفيتامينات", requestDate: "2024-01-18", status: "pending", phone: "0115666777", email: "nora@example.com" }
    ];

    // بيانات تجريبية للنتائج المرسلة
    let sentResults = [
      { patientName: "أحمد محمد محمود", testType: "تحليل صورة دم كاملة", result: "جميع النتائج ضمن المعدل الطبيعي", sentAt: "2024-01-15 14:30", notes: "لا توجد ملاحظات" },
      { patientName: "محمد خالد عبدالله", testType: "وظائف الكبد", result: "إنزيمات الكبد مرتفعة قليلاً، يرجى مراجعة الطبيب", sentAt: "2024-01-14 11:15", notes: "يُنصح بعمل تحليل متابعة بعد شهر" },
      { patientName: "يوسف سمير رجب", testType: "هرمونات الغدة الدرقية", result: "النتائج طبيعية، TSH = 2.1", sentAt: "2024-01-13 16:45", notes: "" }
    ];

    // تحميل بيانات المرضى وعرضها
    function loadPatients() {
      patientsTableBody.innerHTML = '';
      
      patients.forEach(patient => {
        const tr = document.createElement('tr');
        const statusClass = patient.status === 'completed' ? 'completed' : 
                          patient.status === 'pending' ? 'pending' : 'cancelled';
        const statusText = patient.status === 'completed' ? 'مكتمل' : 
                          patient.status === 'pending' ? 'قيد الانتظار' : 'ملغي';
        
        tr.innerHTML = `
          <td>${patient.id}</td>
          <td>${patient.name}</td>
          <td>${patient.age} سنة</td>
          <td>${patient.testType}</td>
          <td>${new Date(patient.requestDate).toLocaleDateString('ar-EG')}</td>
          <td><span class="status ${statusClass}">${statusText}</span></td>
          <td>
            <button class="delete-btn" data-id="${patient.id}">
              <i class="fas fa-trash"></i>
              حذف
            </button>
          </td>
        `;
        patientsTableBody.appendChild(tr);
      });

      // تحديث الإحصائيات
      updateStatistics();
      
      // تحديث قائمة اختيار المرضى
      updatePatientSelect();
      
      // إضافة أحداث الحذف
      addDeleteEvents();
    }

    // تحميل النتائج المرسلة وعرضها
    function loadSentResults() {
      sentResultsTableBody.innerHTML = '';
      
      if (sentResults.length === 0) {
        sentResultsTableBody.innerHTML = `
          <tr>
            <td colspan="5" style="text-align: center; padding: 30px; color: var(--dark-text-secondary);">
              <i class="fas fa-inbox" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
              لا توجد نتائج مرسلة حالياً
            </td>
          </tr>
        `;
        return;
      }
      
      sentResults.forEach((result, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${result.patientName}</td>
          <td>${result.testType}</td>
          <td>${result.result.substring(0, 50)}${result.result.length > 50 ? '...' : ''}</td>
          <td>${new Date(result.sentAt).toLocaleString('ar-EG')}</td>
          <td>
            <button class="delete-btn" data-index="${index}">
              <i class="fas fa-trash"></i>
              حذف
            </button>
          </td>
        `;
        sentResultsTableBody.appendChild(tr);
      });
      
      // إضافة أحداث الحذف للنتائج
      addDeleteResultEvents();
    }

    // تحديث الإحصائيات
    function updateStatistics() {
      const totalPatients = patients.length;
      const pendingTests = patients.filter(p => p.status === 'pending').length;
      const completedTests = patients.filter(p => p.status === 'completed').length;
      const today = new Date().toISOString().split('T')[0];
      const todayAppointments = patients.filter(p => p.requestDate === today).length;
      
      totalPatientsEl.textContent = totalPatients;
      pendingTestsEl.textContent = pendingTests;
      completedTestsEl.textContent = completedTests;
      todayAppointmentsEl.textContent = todayAppointments;
    }

    // تحديث قائمة اختيار المرضى
    function updatePatientSelect() {
      patientSelect.innerHTML = '<option value="">اختر المريض...</option>';
      
      patients.forEach(patient => {
        const option = document.createElement('option');
        option.value = patient.email;
        option.textContent = `${patient.name} - ${patient.testType}`;
        patientSelect.appendChild(option);
      });
    }

    // إضافة أحداث الحذف للمرضى
    function addDeleteEvents() {
      document.querySelectorAll('#patientsTableBody .delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const patientId = parseInt(this.getAttribute('data-id'));
          const patient = patients.find(p => p.id === patientId);
          
          if (!confirm(`هل أنت متأكد من حذف بيانات المريض: ${patient.name}؟`)) return;
          
          // حذف المريض من المصفوفة
          const index = patients.findIndex(p => p.id === patientId);
          if (index !== -1) {
            patients.splice(index, 1);
          }
          
          // إعادة تحميل البيانات
          loadPatients();
          
          // عرض رسالة نجاح
          showResponse('تم حذف بيانات المريض بنجاح', 'success');
        });
      });
    }

    // إضافة أحداث الحذف للنتائج
    function addDeleteResultEvents() {
      document.querySelectorAll('#sentResultsTableBody .delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const resultIndex = parseInt(this.getAttribute('data-index'));
          
          if (!confirm('هل أنت متأكد من حذف هذه النتيجة؟')) return;
          
          // حذف النتيجة من المصفوفة
          sentResults.splice(resultIndex, 1);
          
          // إعادة تحميل البيانات
          loadSentResults();
          
          // عرض رسالة نجاح
          showResponse('تم حذف النتيجة بنجاح', 'success');
        });
      });
    }

    // إرسال نتيجة تحليل
    sendResultBtn.addEventListener('click', function() {
      const patientEmail = patientSelect.value;
      const test = testType.value;
      const result = resultInput.value.trim();
      const notes = notesInput.value.trim();
      
      // التحقق من البيانات
      if (!patientEmail || !test || !result) {
        showResponse('يرجى تعبئة جميع الحقول المطلوبة', 'error');
        return;
      }
      
      // العثور على المريض المختار
      const patient = patients.find(p => p.email === patientEmail);
      if (!patient) {
        showResponse('المريض المحدد غير موجود', 'error');
        return;
      }
      
      // تغيير حالة تحليل المريض إلى مكتمل
      patient.status = 'completed';
      
      // إضافة النتيجة إلى قائمة النتائج المرسلة
      const newResult = {
        patientName: patient.name,
        testType: testType.options[testType.selectedIndex].text,
        result: result,
        sentAt: new Date().toISOString(),
        notes: notes
      };
      
      sentResults.unshift(newResult); // إضافة في بداية المصفوفة
      
      // إعادة تعيين النموذج
      patientSelect.value = '';
      testType.value = '';
      resultInput.value = '';
      notesInput.value = '';
      
      // إعادة تحميل البيانات
      loadPatients();
      loadSentResults();
      
      // عرض رسالة نجاح
      showResponse(`تم إرسال نتيجة التحليل إلى ${patient.name} بنجاح`, 'success');
    });

    // تسجيل خروج
    logoutBtn.addEventListener('click', function() {
      if (confirm('هل أنت متأكد من تسجيل الخروج؟')) {
        // في التطبيق الحقيقي: إرسال طلب تسجيل خروج إلى الخادم
        window.location.href = '/admin-login.html';
      }
    });

    // عرض رسالة الاستجابة
    function showResponse(message, type) {
      sendResponse.textContent = message;
      sendResponse.className = `response ${type} show`;
      
      // إخفاء الرسالة بعد 5 ثواني
      setTimeout(() => {
        sendResponse.classList.remove('show');
      }, 5000);
    }

    // تهيئة الصفحة عند التحميل
    document.addEventListener('DOMContentLoaded', function() {
      loadPatients();
      loadSentResults();
      
      // تحميل أي بيانات إضافية يمكن جلبها من الخادم
      setTimeout(() => {
        // يمكن هنا جلب بيانات إضافية من API
        console.log('تم تحميل لوحة التحكم بنجاح');
      }, 500);
    });
  </script>
</body>

</html>
